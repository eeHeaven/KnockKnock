## QueryDSL 삽질 보고서

#### QueryDSL 오류 수정 - cannot find symbol 문제 
```java
Task :compileQuerydsl FAILED java:13: error: cannot find symbol public class Guestbook extends BaseEntity { ^ symbol: class BaseEntity Note: Running JPAAnnotationProcessor 1 error FAILURE: Build failed with an exception. * What went wrong: Execution failed for task ':compileQuerydsl'. > java.lang.IllegalStateException: Found no type for BaseEntity
```
분명히 책에서 하라는 대로 다 했는데 이런식으로 **cannot find symbol** 문제가 터졌다               
                  
이 문제는 build.gradle 파일 하단에 이 코드를 추가하면 해결된다.       
```java 
compileQuerydsl.doFirst { if(file(querydslDir).exists() ) delete(file(querydslDir)) }
```
문제의 원인은 Querydsl이 셋팅된 프로젝트에서 gradle build 시 QClass가 있는 build/generated/querydsl package를                
처음 만들면 문제 없이 빌드 되었지만, 그 이후 빌드 시 아래와 같은 에러를 뱉으며 빌드가 되지 않는 것이였다.                   

#### 변경된 QueryDsl 언어들
왜인지는 모르겠으나 교재에서 배운 바와 QueryDsl 활용 방법은 다소 달랐다.             
일단 **JPAQueryFactory** 를 final 변수로 injection 받아야 한다.         
그 이후의 문법은 자동완성 메서드명만 봐도 직관적으로 보여서 딱히 정리할 필요가 없어보인다.             
한 가지 알아야 할 점은 기존의 listResult()와 같이 list로 조회 결과를 반환하는 method가 사라지고 이를 fetch() 메서드가 대신하는 것이었다.          

이해를 돕기 위해 해당 부분으로 실제 구현한 코드의 일부를 첨부한다.
```java
private final JPAQueryFactory queryFactory;
 QPost post = QPost.post;
    QPostHashTag postHashTag = QPostHashTag.postHashTag;
    QHashTag qhashTag = QHashTag.hashTag;

    public List<Post> findByTag(String tag){

        List<Post> posts = queryFactory.selectFrom(post).distinct()
                .innerJoin(postHashTag).on(post.id.eq(postHashTag.post.id))
                .where(postHashTag.tag.contains(tag))
                .orderBy(post.timestamp.desc())
                .fetch();
        return posts;
    }
```
#### 궁금한 점이 있다면 
여기서의 fetch는 fetch join의 fetch가 아닌것인가?         
아니라면 fetch join 을 하고싶을 때는 queryDSL 을 활용해서 어떻게 구현할 수 있나?              
정도인데 이것은 나중에 찾아서 추후 정리할 예정이다.              


## 성능과 구현 개선 관련 고민 

Entity에서 연관관계로 이미 필드가 있는 List는 따로 조회 repository가 필요없지 않을까? (예를 들어 각 포스트에 해당하는 comment들 list 조회)                     
